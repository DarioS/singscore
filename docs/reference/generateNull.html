<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Permutation test for the derived scores of each sample — generateNull • singscore</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Permutation test for the derived scores of each sample — generateNull" />
<meta property="og:description" content="This function generates a number of random gene sets that
have the same number of genes as the scored gene set. It scores each random
gene set and returns a matrix of scores for all samples.
The empirical scores are used to calculate the empirical p-values and plot
the null distribution. The implementation uses BiocParallel::bplapply()
for easy access to parallel backends. Note that one should pass the same
values to the upSet, downSet, centerScore and bidirectional
arguments as what they provide for the simpleScore() function to generate
a proper null distribution." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">singscore</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.7.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/singscore.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/DavisLaboratory/singscore">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Permutation test for the derived scores of each sample</h1>
    <small class="dont-index">Source: <a href='https://github.com/DavisLaboratory/singscore/blob/master/R/generatNullGeneric.R'><code>R/generatNullGeneric.R</code></a></small>
    <div class="hidden name"><code>generateNull.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function generates a number of random gene sets that
have the same number of genes as the scored gene set. It scores each random
gene set and returns a matrix of scores for all samples.
The empirical scores are used to calculate the empirical p-values and plot
the null distribution. The implementation uses <code><a href='https://rdrr.io/pkg/BiocParallel/man/bplapply.html'>BiocParallel::bplapply()</a></code>
for easy access to parallel backends. Note that one should pass the same
values to the <code>upSet</code>, <code>downSet</code>, <code>centerScore</code> and <code>bidirectional</code>
arguments as what they provide for the <code><a href='simpleScore.html'>simpleScore()</a></code> function to generate
a proper null distribution.</p>
    </div>

    <pre class="usage"><span class='fu'>generateNull</span>(
  <span class='no'>upSet</span>,
  <span class='kw'>downSet</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>rankData</span>,
  <span class='kw'>subSamples</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>centerScore</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>knownDirection</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample.int</a></span>(<span class='fl'>1e+06</span>, <span class='fl'>1</span>),
  <span class='kw'>useBPPARAM</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)

<span class='co'># S4 method for vector,missing</span>
<span class='fu'>generateNull</span>(
  <span class='no'>upSet</span>,
  <span class='kw'>downSet</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>rankData</span>,
  <span class='kw'>subSamples</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>centerScore</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>knownDirection</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample.int</a></span>(<span class='fl'>1e+06</span>, <span class='fl'>1</span>),
  <span class='kw'>useBPPARAM</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)

<span class='co'># S4 method for GeneSet,missing</span>
<span class='fu'>generateNull</span>(
  <span class='no'>upSet</span>,
  <span class='kw'>downSet</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>rankData</span>,
  <span class='kw'>subSamples</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>centerScore</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>knownDirection</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample.int</a></span>(<span class='fl'>1e+06</span>, <span class='fl'>1</span>),
  <span class='kw'>useBPPARAM</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)

<span class='co'># S4 method for vector,vector</span>
<span class='fu'>generateNull</span>(
  <span class='no'>upSet</span>,
  <span class='kw'>downSet</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>rankData</span>,
  <span class='kw'>subSamples</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>centerScore</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>knownDirection</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample.int</a></span>(<span class='fl'>1e+06</span>, <span class='fl'>1</span>),
  <span class='kw'>useBPPARAM</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)

<span class='co'># S4 method for GeneSet,GeneSet</span>
<span class='fu'>generateNull</span>(
  <span class='no'>upSet</span>,
  <span class='kw'>downSet</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>rankData</span>,
  <span class='kw'>subSamples</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>centerScore</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>knownDirection</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample.int</a></span>(<span class='fl'>1e+06</span>, <span class='fl'>1</span>),
  <span class='kw'>useBPPARAM</span> <span class='kw'>=</span> <span class='kw'>NULL</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>upSet</th>
      <td><p>A GeneSet object or character vector of gene IDs of up-regulated
gene set or a gene set where the nature of genes is not known</p></td>
    </tr>
    <tr>
      <th>downSet</th>
      <td><p>A GeneSet object or character vector of gene IDs of
down-regulated gene set or NULL where only a single gene set is provided</p></td>
    </tr>
    <tr>
      <th>rankData</th>
      <td><p>A matrix object, ranked gene expression matrix data generated
using the <code><a href='rankGenes.html'>rankGenes()</a></code> function (make sure this matrix is not modified, see
details)</p></td>
    </tr>
    <tr>
      <th>subSamples</th>
      <td><p>A vector of sample labels/indices that will be used to
subset the rankData matrix. All samples will be scored if not provided</p></td>
    </tr>
    <tr>
      <th>centerScore</th>
      <td><p>A Boolean, specifying whether scores should be centered
around 0, default as TRUE. Note: scores never centered if <code>knownDirection = FALSE</code></p></td>
    </tr>
    <tr>
      <th>knownDirection</th>
      <td><p>A boolean, determining whether the gene set should be
considered to be directional or not. A gene set is directional if the type
of genes in it are known i.e. up- or down-regulated. This should be set to
TRUE if the gene set is composed of both up- AND down-regulated genes.
Defaults to TRUE. This parameter becomes irrelevant when both upSet(Colc)
and downSet(Colc) are provided.</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>integer, the number of permutation repeats or the number of random
gene sets to be generated, default as 1000</p></td>
    </tr>
    <tr>
      <th>ncores, </th>
      <td><p>integer, the number of CPU cores the function can use</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>integer, set the seed for randomisation</p></td>
    </tr>
    <tr>
      <th>useBPPARAM, </th>
      <td><p>the backend the function uses, if NULL is provided, the
function uses the default parallel backend which is the first on the list
returned by <code><a href='https://rdrr.io/pkg/BiocParallel/man/register.html'>BiocParallel::registered()</a></code> i.e
<code>BiocParallel::registered()[[1]]</code> for your machine. It can be changed
explicitly by passing a BPPARAM</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A matrix of empirical scores for all samples</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='http://lcolladotor.github.io/2016/03/07/BiocParallel/#.WgXMF61L28U'>Post about BiocParallel</a>
<code><a href='https://rdrr.io/r/utils/browseVignettes.html'>browseVignettes("BiocParallel")</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>ranked</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rankGenes.html'>rankGenes</a></span>(<span class='no'>toy_expr_se</span>)
<span class='no'>scoredf</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='simpleScore.html'>simpleScore</a></span>(<span class='no'>ranked</span>, <span class='kw'>upSet</span> <span class='kw'>=</span> <span class='no'>toy_gs_up</span>, <span class='kw'>downSet</span> <span class='kw'>=</span> <span class='no'>toy_gs_dn</span>)

<span class='co'># find out what backends can be registered on your machine</span>
<span class='kw pkg'>BiocParallel</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/BiocParallel/man/register.html'>registered</a></span>()</div><div class='output co'>#&gt; $MulticoreParam
#&gt; class: MulticoreParam
#&gt;   bpisup: FALSE; bpnworkers: 30; bptasks: 0; bpjobname: BPJOB
#&gt;   bplog: FALSE; bpthreshold: INFO; bpstopOnError: TRUE
#&gt;   bpRNGseed: ; bptimeout: 2592000; bpprogressbar: FALSE
#&gt;   bpexportglobals: TRUE
#&gt;   bplogdir: NA
#&gt;   bpresultdir: NA
#&gt;   cluster type: FORK
#&gt; 
#&gt; $SnowParam
#&gt; class: SnowParam
#&gt;   bpisup: FALSE; bpnworkers: 30; bptasks: 0; bpjobname: BPJOB
#&gt;   bplog: FALSE; bpthreshold: INFO; bpstopOnError: TRUE
#&gt;   bpRNGseed: ; bptimeout: 2592000; bpprogressbar: FALSE
#&gt;   bpexportglobals: TRUE
#&gt;   bplogdir: NA
#&gt;   bpresultdir: NA
#&gt;   cluster type: SOCK
#&gt; 
#&gt; $SerialParam
#&gt; class: SerialParam
#&gt;   bpisup: FALSE; bpnworkers: 1; bptasks: 0; bpjobname: BPJOB
#&gt;   bplog: FALSE; bpthreshold: INFO; bpstopOnError: TRUE
#&gt;   bpRNGseed: ; bptimeout: 2592000; bpprogressbar: FALSE
#&gt;   bpexportglobals: TRUE
#&gt;   bplogdir: NA
#&gt;   bpresultdir: NA
#&gt; </div><div class='input'><span class='co'># the first one is the default backend</span>
<span class='co'># ncores = ncores &lt;- parallel::detectCores() - 2</span>
<span class='no'>permuteResult</span> <span class='kw'>=</span> <span class='fu'>generateNull</span>(<span class='kw'>upSet</span> <span class='kw'>=</span> <span class='no'>toy_gs_up</span>, <span class='kw'>downSet</span> <span class='kw'>=</span> <span class='no'>toy_gs_dn</span>, <span class='no'>ranked</span>,
<span class='kw'>centerScore</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>B</span> <span class='kw'>=</span><span class='fl'>10</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>1</span> )</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ruqian Lyu, Momeneh Foroutan, Dharmesh D. Bhuva.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


